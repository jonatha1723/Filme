<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Double Wit - Mobile Login</title>
    
    <!-- Tailwind CSS para design responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <!-- Ícones Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { 
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Remove o brilho de toque no Android */
        }
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        /* Animação suave de entrada */
        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Estilo para botões mobile */
        .btn-touch {
            transition: transform 0.1s active, opacity 0.2s;
        }
        .btn-touch:active {
            transform: scale(0.96);
            opacity: 0.9;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- OVERLAY DE CARREGAMENTO -->
    <div id="loader" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-white">
        <div class="w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
        <p class="mt-4 text-slate-500 font-medium">A carregar...</p>
    </div>

    <div class="app-container">
        
        <!-- TELA DE LOGIN -->
        <div id="login-view" class="hidden flex-1 flex flex-col items-center justify-center p-6 fade-in">
            <div class="w-full max-w-sm">
                <div class="flex justify-center mb-8">
                    <div class="p-5 bg-indigo-600 rounded-3xl shadow-xl shadow-indigo-200">
                        <i data-lucide="shield-check" class="text-white w-12 h-12"></i>
                    </div>
                </div>

                <div class="text-center mb-10">
                    <h1 class="text-4xl font-black text-slate-900 tracking-tight">Double Wit</h1>
                    <p class="text-slate-500 mt-2">Inicie sessão para gerir o seu painel</p>
                </div>

                <!-- Mensagem de Erro -->
                <div id="error-box" class="hidden mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-lg text-red-700 text-sm flex items-start gap-3">
                    <i data-lucide="alert-circle" class="w-5 h-5 shrink-0"></i>
                    <span id="error-msg"></span>
                </div>

                <!-- Botão de Login Google -->
                <button id="btn-google" class="btn-touch w-full flex items-center justify-center gap-4 py-4 px-6 bg-white border-2 border-slate-200 rounded-2xl text-slate-700 font-bold shadow-sm">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" class="w-6 h-6">
                    <span>Entrar com Google</span>
                </button>

                <p class="mt-12 text-center text-[10px] text-slate-400 uppercase tracking-widest font-bold">
                    Autenticação Segura via Firebase
                </p>
            </div>
        </div>

        <!-- TELA DASHBOARD (PÓS-LOGIN) -->
        <div id="dashboard-view" class="hidden flex-1 flex flex-col fade-in">
            <!-- Header Mobile -->
            <header class="bg-white border-b border-slate-200 p-5 flex items-center justify-between sticky top-0 z-10">
                <div class="flex items-center gap-2">
                    <div class="bg-indigo-600 p-1.5 rounded-lg">
                        <i data-lucide="shield-check" class="text-white w-5 h-5"></i>
                    </div>
                    <span class="font-extrabold text-slate-800 tracking-tighter">DOUBLE WIT</span>
                </div>
                <button id="btn-logout" class="p-2 text-slate-400 hover:text-red-500">
                    <i data-lucide="log-out"></i>
                </button>
            </header>

            <!-- Conteúdo Dash -->
            <main class="flex-1 p-5 space-y-6 overflow-y-auto">
                <!-- Perfil -->
                <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm flex items-center gap-5">
                    <img id="u-photo" src="" class="w-16 h-16 rounded-2xl bg-slate-100 border-2 border-indigo-50 shadow-inner" alt="User">
                    <div>
                        <h2 id="u-name" class="text-xl font-bold text-slate-900 leading-tight"></h2>
                        <p id="u-email" class="text-sm text-slate-500"></p>
                    </div>
                </div>

                <!-- Grid de Cards -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-indigo-600 p-5 rounded-3xl text-white shadow-lg shadow-indigo-100 col-span-2">
                        <p class="text-indigo-200 text-xs font-bold uppercase tracking-widest">Saldo Atual</p>
                        <h3 class="text-3xl font-black mt-1">1.250 <span class="text-lg font-normal opacity-80">pts</span></h3>
                    </div>
                    
                    <div class="bg-white p-5 rounded-3xl border border-slate-200 shadow-sm">
                        <i data-lucide="activity" class="text-indigo-600 w-5 h-5 mb-2"></i>
                        <p class="text-slate-400 text-[10px] font-bold uppercase">Atividade</p>
                        <h4 class="text-xl font-bold">42</h4>
                    </div>

                    <div class="bg-white p-5 rounded-3xl border border-slate-200 shadow-sm">
                        <i data-lucide="layers" class="text-indigo-600 w-5 h-5 mb-2"></i>
                        <p class="text-slate-400 text-[10px] font-bold uppercase">Projetos</p>
                        <h4 class="text-xl font-bold">08</h4>
                    </div>
                </div>

                <div class="bg-white p-5 rounded-3xl border border-slate-200 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-4">Ações Rápidas</h3>
                    <div class="space-y-3">
                        <button class="w-full flex items-center justify-between p-4 bg-slate-50 rounded-2xl font-semibold text-slate-700">
                            <span>Sincronizar Dados</span>
                            <i data-lucide="chevron-right" class="w-4 h-4"></i>
                        </button>
                        <button class="w-full flex items-center justify-between p-4 bg-slate-50 rounded-2xl font-semibold text-slate-700">
                            <span>Configurações</span>
                            <i data-lucide="chevron-right" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </main>
        </div>

    </div>

    <!-- Firebase SDK (Modular CDN) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        // Configuração Double Wit
        const firebaseConfig = {
            apiKey: "AIzaSyC-DTG7MauMSyvUKDcMxAhLLRAMIyKnYFE",
            authDomain: "double-wit.firebaseapp.com",
            projectId: "double-wit",
            storageBucket: "double-wit.firebasestorage.app",
            messagingSenderId: "2191174521",
            appId: "1:2191174521:web:9268d53b6431fd24cb5da8"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Referências UI
        const loader = document.getElementById('loader');
        const loginView = document.getElementById('login-view');
        const dashboardView = document.getElementById('dashboard-view');
        const btnGoogle = document.getElementById('btn-google');
        const btnLogout = document.getElementById('btn-logout');
        const errorBox = document.getElementById('error-box');
        const errorMsg = document.getElementById('error-msg');

        // Observer de Autenticação
        onAuthStateChanged(auth, (user) => {
            loader.classList.add('hidden');
            if (user) {
                // Preencher Dashboard
                document.getElementById('u-name').innerText = user.displayName;
                document.getElementById('u-email').innerText = user.email;
                document.getElementById('u-photo').src = user.photoURL || 'https://via.placeholder.com/100';
                
                loginView.classList.add('hidden');
                dashboardView.classList.remove('hidden');
            } else {
                dashboardView.classList.add('hidden');
                loginView.classList.remove('hidden');
            }
            lucide.createIcons();
        });

        // Função de Login
        btnGoogle.onclick = async () => {
            errorBox.classList.add('hidden');
            btnGoogle.disabled = true;
            btnGoogle.classList.add('opacity-50');
            
            try {
                await signInWithPopup(auth, provider);
            } catch (error) {
                console.error(error);
                errorBox.classList.remove('hidden');
                errorMsg.innerText = "Erro ao autenticar. Verifique a conexão ou as permissões do WebView.";
            } finally {
                btnGoogle.disabled = false;
                btnGoogle.classList.remove('opacity-50');
            }
        };

        // Função Logout
        btnLogout.onclick = () => signOut(auth);

        // Inicializar Ícones
        lucide.createIcons();
    </script>
</body>
</html>

